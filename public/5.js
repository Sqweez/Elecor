(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{10:function(t,e,n){"use strict";var a={props:{state:{type:Boolean,default:!1},title:{type:String,default:"Подтвердите действие"},message:{type:String,required:!0},okMessage:{type:String,default:"ОК"},cancelMessage:{type:String,default:"Отмена"}},methods:{onConfirm:function(){this.$emit("confirm")},onCancel:function(){this.$emit("cancel")}}},o=(n(55),n(2)),s=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"500"},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[n("v-card",[n("v-card-title",{staticClass:"headline blue darken-1 justify-content-between"},[n("span",{staticClass:"white--text"},[t._v(t._s(t.title))]),t._v(" "),n("v-btn",{staticClass:"float-right",attrs:{icon:"",text:""}},[n("v-icon",{attrs:{color:"white"},on:{click:t.onCancel}},[t._v("\n                        mdi-close\n                    ")])],1)],1),t._v(" "),n("v-card-text",{staticClass:"modal-text"},[t._v("\n                "+t._s(t.message)+"\n            ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:""},on:{click:t.onCancel}},[t._v("\n                    "+t._s(t.cancelMessage)+"\n                ")]),t._v(" "),n("v-btn",{attrs:{color:"success",text:""},on:{click:t.onConfirm}},[t._v("\n                    "+t._s(t.okMessage)+"\n                    "),n("v-icon",[t._v("mdi-check")])],1)],1)],1)],1)],1)}),[],!1,null,"2adaa561",null);e.a=s.exports},12:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return r}));var a=n(0),o=n.n(a),s=n(3),i=n.n(s);function c(t){var e,n,a,s=arguments;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=s.length>1&&void 0!==s[1]?s[1]:"file",(n=new FormData).append(e,t),a={headers:{"content-type":"multipart/form-data"}},c.next=6,o.a.awrap(i.a.post("/api/upload",n,a));case 6:return c.abrupt("return",c.sent);case 7:case"end":return c.stop()}}))}function r(t){var e;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return(e=new FormData).append("file",t),n.next=4,o.a.awrap(i.a.post("/api/delete",e));case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}))}},20:function(t,e,n){var a=n(56);"string"==typeof a&&(a=[[t.i,a,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(9)(a,o);a.locals&&(t.exports=a.locals)},55:function(t,e,n){"use strict";var a=n(20);n.n(a).a},56:function(t,e,n){(t.exports=n(8)(!1)).push([t.i,"\n.modal-text[data-v-2adaa561] {\n    margin-top: 15px!important;;\n    font-size: 16px;\n}\n",""])},91:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),s=n(10),i=n(29),c=n.n(i),r=(n(39),n(12)),l=n(1),d={props:{state:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},title:{type:String,default:"Добавление новости"},okButton:{type:String,default:"Создать"},currentStock:{type:Object,default:function(){return{title:"",body:"",image:null}}}},data:function(){return{loading:!1,editor:c.a,editorConfig:{language:"ru",height:700,autoGrow_minHeight:400}}},methods:{onSubmit:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.editMode){t.next=5;break}return t.next=3,o.a.awrap(this.editStock());case 3:t.next=7;break;case 5:return t.next=7,o.a.awrap(this.createStock());case 7:case"end":return t.stop()}}),null,this)},editStock:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,o.a.awrap(this.$store.dispatch(l.a.EDIT_STOCK,{id:this.currentStock.id,image:this.currentStock.image,body:this.currentStock.body,title:this.currentStock.title}));case 3:this.$emit("onSave");case 4:case"end":return t.stop()}}),null,this)},createStock:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,o.a.awrap(this.$store.dispatch(l.a.CREATE_STOCK,{image:this.currentStock.image,body:this.currentStock.body,title:this.currentStock.title}));case 3:this.$emit("onSave");case 4:case"end":return t.stop()}}),null,this)},choosePhoto:function(){this.$refs.fileInput.click()},uploadPhoto:function(t){var e;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(Object(r.a)(t.target.files[0]));case 2:e=n.sent,this.currentStock.image=e.data;case 4:case"end":return n.stop()}}),null,this)}}},u=n(2),v=Object(u.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"800",persistent:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[n("v-card",[n("v-card-title",{staticClass:"headline blue darken-1 justify-content-between"},[n("span",{staticClass:"white--text"},[t._v(t._s(t.title))]),t._v(" "),n("v-btn",{staticClass:"float-right",attrs:{icon:"",text:""},on:{click:function(e){return t.$emit("onClose")}}},[n("v-icon",{attrs:{color:"white"}},[t._v("\n                    mdi-close\n                ")])],1)],1),t._v(" "),n("v-card-text",[t.loading?t._e():n("v-form",{staticClass:"p-2"},[n("v-text-field",{attrs:{label:"Заголовок"},model:{value:t.currentStock.title,callback:function(e){t.$set(t.currentStock,"title",e)},expression:"currentStock.title"}}),t._v(" "),n("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig,rows:"10"},model:{value:t.currentStock.body,callback:function(e){t.$set(t.currentStock,"body",e)},expression:"currentStock.body"}}),t._v(" "),n("input",{ref:"fileInput",staticClass:"d-none",attrs:{type:"file"},on:{change:t.uploadPhoto}}),t._v(" "),t.currentStock.image?n("img",{staticClass:"mt-2 mb-2",staticStyle:{"max-width":"400px",height:"auto"},attrs:{src:"../storage/"+t.currentStock.image,alt:""}}):t._e(),t._v(" "),n("div",[n("v-btn",{staticClass:"mt-4",attrs:{color:"primary","max-width":"400"},on:{click:t.choosePhoto}},[t._v("Загрузите фото\n                        "),n("v-icon",{staticClass:"ml-2"},[t._v("mdi-upload")])],1)],1)],1)],1),t._v(" "),n("v-divider"),t._v(" "),t.loading?t._e():n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(e){return t.$emit("onClose")}}},[t._v("Отмена")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:"",color:"success"},on:{click:t.onSubmit}},[n("b",[t._v(t._s(t.okButton))]),t._v(" "),n("v-icon",[t._v("mdi-check")])],1)],1),t._v(" "),n("v-progress-linear",{attrs:{indeterminate:"",active:t.loading,color:"green",absolute:"",bottom:""}})],1)],1)}),[],!1,null,"0588e1f0",null).exports,h=n(4),f={components:{AddNewsModal:v,ConfirmationModal:s.a},methods:{closeDeleteModal:function(){this.deleteModal=!1},closeHideModal:function(){this.hideModal=!1},closeAddModal:function(){this.addModal=!1,Object(h.a)("","Новость успешно добавлена!")},closeEditModal:function(){this.editModal=!1,Object(h.a)("","Новость успешно изменена!")}},data:function(){return{editModal:!1,addModal:!1,hideModal:!1,deleteModal:!1,headers:[{text:"Наименование",value:"title",sortable:!1},{text:"Дата создания",value:"date",sortable:!1},{text:"Действие",value:"action",sortable:!1}],items:[{title:"Новая новость",date:"21.10.2019",isVisible:!0},{title:"Новая новость 2",date:"21.10.2019",isVisible:!1}],search:""}}},p=Object(u.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"d-flex justify-content-between"},[n("v-btn",{staticClass:"button-add",attrs:{color:"primary"}},[t._v("\n            Экспорт данных\n            "),n("v-icon",[t._v("mdi-file-excel-box")])],1),t._v(" "),n("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.addModal=!0}}},[t._v("\n            Добавить новость\n            "),n("v-icon",[t._v("mdi-plus")])],1)],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-spacer"),t._v(" "),n("v-text-field",{staticClass:"mb-2",attrs:{clearable:"","append-icon":"mdi-account-search",label:"Поиск","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),n("v-data-table",{attrs:{"no-results-text":"Нет результатов","no-data-text":"Нет данных","footer-props":{"items-per-page-options":[10,15,{text:"Все",value:-1}],"items-per-page-text":"Записей на странице"},headers:t.headers,search:t.search,items:t.items},scopedSlots:t._u([{key:"item.action",fn:function(e){var a=e.item;return[n("v-btn",{attrs:{icon:""},on:{click:function(e){t.hideModal=!0}}},[a.isVisible?n("v-icon",[t._v("mdi-eye-off")]):n("v-icon",[t._v("mdi-eye")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.editModal=!0}}},[n("v-icon",[t._v("mdi-pencil-outline")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.deleteModal=!0}}},[n("v-icon",[t._v("mdi-delete")])],1)]}},{key:"footer.page-text",fn:function(e){var n=e.pageStart,a=e.pageStop,o=e.itemsLength;return[t._v("\n            "+t._s(n)+"-"+t._s(a)+" из "+t._s(o)+"\n        ")]}}])}),t._v(" "),n("ConfirmationModal",{attrs:{message:"Вы действительно хотите удалить выбранную новость?",state:t.deleteModal,"ok-message":"Удалить"},on:{cancel:t.closeDeleteModal,confirm:t.closeDeleteModal}}),t._v(" "),n("ConfirmationModal",{attrs:{"ok-message":"Скрыть",message:"Вы действительно хотите скрыть выбранную новость?",state:t.hideModal},on:{cancel:t.closeHideModal,confirm:t.closeHideModal}}),t._v(" "),n("AddNewsModal",{attrs:{state:t.addModal},on:{onClose:t.closeAddModal}}),t._v(" "),n("AddNewsModal",{attrs:{title:"Редактирование новости","ok-button":"Сохранить","edit-mode":!0,state:t.editModal},on:{onClose:t.closeEditModal}})],1)}),[],!1,null,"75c4b975",null).exports,m={components:{ConfirmationModal:s.a,AddNewsModal:v},computed:{stocks:function(){return this.$store.getters.stocks}},data:function(){return{modalKey:0,currentStock:null,modalMessage:"",deleteModal:!1,hideModal:!1,addModal:!1,editModal:!1,headers:[{text:"Наименование",value:"title",sortable:!1},{text:"Дата создания",value:"date",sortable:!1},{text:"Действие",value:"action",sortable:!1}],search:""}},methods:{showDeleteModal:function(t){this.currentStock=t,this.deleteModal=!0},showHideModal:function(t){this.currentStock=t,this.currentStock.is_visible?this.modalMessage="Вы действительно хотите скрыть данную акцию?":this.modalMessage="Вы действительно хотите показать данную акцию?",this.hideModal=!0},showEditModal:function(t){this.currentStock=t,this.editModal=!0},closeDeleteModal:function(){this.deleteModal=!1},closeHideModal:function(){this.hideModal=!1},closeAddModal:function(){this.addModal=!1,this.modalKey++},closeEditModal:function(){this.editModal=!1,this.modalKey++},stockCreated:function(){this.addModal=!1,Object(h.a)("Акция успешно добавлена!"),this.modalKey++,this.currentStock=null},stockEdited:function(){this.editModal=!1,Object(h.a)("Акция успешно обновлена!"),this.modalKey++,this.currentStock=null},deleteStock:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(this.$store.dispatch(l.a.DELETE_STOCK,this.currentStock.id));case 2:this.currentStock=null,this.deleteModal=!1;case 4:case"end":return t.stop()}}),null,this)},changeStockStatus:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.hideModal=!1,t.next=3,o.a.awrap(this.$store.dispatch(l.a.CHANGE_STOCK_STATUS,{id:this.currentStock.id,is_visible:!this.currentStock.is_visible}));case 3:Object(h.a)("Акция успешно обновлена!"),this.currentStock=null;case 5:case"end":return t.stop()}}),null,this)}}},_={components:{NewsSegment:p,StocksSegment:Object(u.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"d-flex justify-content-between"},[n("v-btn",{staticClass:"button-add",attrs:{color:"primary"}},[t._v("\n            Экспорт данных\n            "),n("v-icon",[t._v("mdi-file-excel-box")])],1),t._v(" "),n("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.addModal=!0}}},[t._v("\n            Добавить акцию\n            "),n("v-icon",[t._v("mdi-plus")])],1)],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-spacer"),t._v(" "),n("v-text-field",{staticClass:"mb-2",attrs:{clearable:"","append-icon":"mdi-account-search",label:"Поиск","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),t.stocks?n("v-data-table",{attrs:{"no-results-text":"Нет результатов","no-data-text":"Нет данных","footer-props":{"items-per-page-options":[10,15,{text:"Все",value:-1}],"items-per-page-text":"Записей на странице"},headers:t.headers,search:t.search,items:t.stocks},scopedSlots:t._u([{key:"item.action",fn:function(e){var a=e.item;return[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showHideModal(a)}}},[a.is_visible?n("v-icon",[t._v("mdi-eye-off")]):n("v-icon",[t._v("mdi-eye")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showEditModal(a)}}},[n("v-icon",[t._v("mdi-pencil-outline")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showDeleteModal(a)}}},[n("v-icon",[t._v("mdi-delete")])],1)]}},{key:"footer.page-text",fn:function(e){var n=e.pageStart,a=e.pageStop,o=e.itemsLength;return[t._v("\n            "+t._s(n)+"-"+t._s(a)+" из "+t._s(o)+"\n        ")]}}],null,!1,582661117)}):t._e(),t._v(" "),n("ConfirmationModal",{attrs:{message:"Вы действительно хотите удалить выбранную акцию?",state:t.deleteModal,"ok-message":"Удалить"},on:{cancel:t.closeDeleteModal,confirm:t.deleteStock}}),t._v(" "),n("ConfirmationModal",{attrs:{"ok-message":"Скрыть",message:t.modalMessage,state:t.hideModal},on:{cancel:t.closeHideModal,confirm:t.changeStockStatus}}),t._v(" "),n("AddNewsModal",{key:t.modalKey,attrs:{title:"Добавление акции",state:t.addModal},on:{onClose:t.closeAddModal,onSave:t.stockCreated}}),t._v(" "),t.editModal?n("AddNewsModal",{key:t.modalKey+1,attrs:{title:"Редактирование акции","ok-button":"Сохранить",currentStock:t.currentStock,"edit-mode":!0,state:t.editModal},on:{onClose:t.closeEditModal,onSave:t.stockEdited}}):t._e()],1)}),[],!1,null,"c77a4e94",null).exports},mounted:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(this.$store.dispatch(l.a.GET_STOCKS));case 2:case"end":return t.stop()}}),null,this)},data:function(){return{currentSegment:"stocks"}},methods:{switchSegment:function(){this.currentSegment="news"===this.currentSegment?"stocks":"news"}}},k=Object(u.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[t._v("\n        Акции\n    ")]),t._v(" "),n("v-card-text",[n("div",{staticClass:"d-flex p-2"},[n("v-btn",{staticStyle:{width:"300px"},attrs:{depressed:"",color:"stocks"===t.currentSegment?"primary":""},on:{click:function(e){t.currentSegment="stocks"}}},[t._v("Акции\n            ")])],1),t._v(" "),n("div",{staticClass:"p-4"},["news"===t.currentSegment?n("NewsSegment"):n("StocksSegment")],1)])],1)}),[],!1,null,"612f11e7",null);e.default=k.exports}}]);